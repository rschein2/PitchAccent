# 数詞アクセント規則 (Numeral Accent Rules)

日本語において数詞と助数詞（カウンター）が結合する際、アクセントは複雑な規則に従います。宮崎ら（2012）の研究に基づき、助数詞をカテゴリー（α-ν）に分類し、数詞との組み合わせでアクセントパターンを決定します。

## 基本概念

### 助数詞カテゴリー

助数詞は音韻的・意味的特性に基づいて13のカテゴリー（α-ν）に分類されます：

| カテゴリー | 助数詞例 | 特徴 |
|-----------|---------|------|
| α | つ、個、枚 | 一般的なカウンター |
| β | 本、杯 | 長いもの、容器 |
| γ | 階、軒 | 建物関連 |
| δ | 年、月、週 | 時間（暦）|
| ε | 回、度 | 回数 |
| ζ | 分、秒 | 時間（単位）|
| η | 円 | 通貨 |
| θ | 歳、才 | 年齢 |
| ι | 時、時間 | 時刻・時間 |
| κ | 日、日間 | 日数 |
| λ | 人、名 | 人数 |
| μ | 台、匹、頭 | 機械・動物 |
| ν | 番、号 | 番号・順序 |

### オーバーライドコード

各（数詞, カテゴリー）の組み合わせに対して、以下の4種類のコードが割り当てられます：

| コード | 意味 | 例 |
|--------|------|-----|
| 0 | 通常の結合規則 | 複合名詞と同様 |
| 1 | 平板化 | ～年の多く |
| 2 | 助数詞初頭にアクセント | ～人（5人以上）|
| 3 | 助数詞末尾にアクセント | 一部の特殊形 |

## カテゴリー別アクセントパターン

### δカテゴリー（年、月、週）

ほぼすべて平板型になります。

```
1年 いちねん [0] LHHHH
2年 にねん [0] LHH
3年 さんねん [0] LHHH
...
2024年 にせんにじゅうよんねん [0] LHHHHHHHHHH
```

### λカテゴリー（人、名）

特殊な読みと不規則なアクセントを持ちます。

```
1人 ひとり [2] LHL ← 特殊読み
2人 ふたり [2] LHL ← 特殊読み
3人 さんにん [0] LHHH ← 平板
4人 よにん [0] LHH ← よん→よ
5人 ごにん [2] LHL ← 助数詞初頭
6人 ろくにん [3] LHHL
...
```

### βカテゴリー（本、杯）

促音挿入と濁音化が発生します。

```
1本 いっぽん [3] LHHL ← いち→いっ、ほん→ぽん
2本 にほん [2] LHL
3本 さんぼん [1] HLLL ← ほん→ぼん（濁音化）
4本 よんほん [3] LHHL
5本 ごほん [2] LHL
6本 ろっぽん [3] LHHL ← ろく→ろっ、ほん→ぽん
...
```

### κカテゴリー（日）

1-10日は完全に不規則な読みを持ちます。

```
1日 ついたち [4] LHHHL ← 特殊
2日 ふつか [0] LHH
3日 みっか [0] LHH
4日 よっか [0] LHH
5日 いつか [0] LHH
6日 むいか [0] LHH
7日 なのか [0] LHH
8日 ようか [0] LHH
9日 ここのか [2] LHLL
10日 とおか [0] LHH
```

11日以降は規則的：
```
11日 じゅういちにち
14日 じゅうよっか ← 4日の読みを保持
20日 はつか ← 特殊
24日 にじゅうよっか
```

### ιカテゴリー（時）

すべて助数詞初頭にアクセント（コード2）。

```
1時 いちじ [2] LHL
2時 にじ [1] HL
3時 さんじ [1] HL
4時 よじ [1] HL ← よん→よ
5時 ごじ [1] HL
6時 ろくじ [2] LHL
7時 しちじ [2] LHL ← なな→しち
8時 はちじ [2] LHL
9時 くじ [1] HL ← きゅう→く
10時 じゅうじ [1] HLL
```

## 音韻変化（読み替え）

数詞と助数詞の境界で様々な音韻変化が発生します。

### 促音挿入（そくおんそうにゅう）

```python
READING_ALTERNATIONS = {
    (1, "本"): ("いっ", "ぽん"),  # いち→いっ
    (6, "本"): ("ろっ", "ぽん"),  # ろく→ろっ
    (8, "本"): ("はっ", "ぽん"),  # はち→はっ
    (10, "本"): ("じゅっ", "ぽん"),  # じゅう→じゅっ
    (1, "回"): ("いっ", "かい"),
    (6, "回"): ("ろっ", "かい"),
    (8, "回"): ("はっ", "かい"),
    ...
}
```

### 濁音化（だくおんか）

```python
(3, "本"): ("さん", "ぼん"),  # ほん→ぼん
(3, "杯"): ("さん", "ばい"),  # はい→ばい
```

### 特殊読み

```python
# 人
(1, "人"): ("ひと", "り"),   # いちにん ではない
(2, "人"): ("ふた", "り"),   # ににん ではない

# 時
(4, "時"): ("よ", "じ"),     # よんじ ではない
(7, "時"): ("しち", "じ"),   # ななじ ではない
(9, "時"): ("く", "じ"),     # きゅうじ ではない

# 日
(1, "日"): ("つい", "たち"),
(2, "日"): ("ふつ", "か"),
(20, "日"): ("はつ", "か"),
...
```

## アクセント計算の実装

```python
def compute_numeral_phrase_accent(numeral, counter, counter_accent=0):
    category = get_counter_category(counter)
    num_reading, counter_reading = get_numeral_counter_reading(numeral, counter)

    full_reading = num_reading + counter_reading
    num_mora = count_mora(num_reading)
    counter_mora = count_mora(counter_reading)

    # オーバーライドテーブルを参照
    override = NUMERAL_COUNTER_OVERRIDES.get((numeral, category))

    if override == 0:  # 通常結合
        if counter_mora <= 2:
            return num_mora  # 数詞末にアクセント
        else:
            return num_mora + 1  # 助数詞初頭にアクセント
    elif override == 1:  # 平板
        return 0
    elif override == 2:  # 助数詞初頭
        return num_mora + 1
    elif override == 3:  # 助数詞末尾
        return num_mora + counter_mora
```

## 本ツールの制限

### 未実装の機能

1. **連濁（れんだく）**: さんびゃく、ろっぴゃく など
   - 現在は「さんひゃく」「ろくひゃく」と出力

2. **大きな数の完全対応**: 億、兆 などの位
   - 基本的な変換は可能だが、アクセントは簡略化

3. **すべての助数詞**: カテゴリー未登録の助数詞
   - 登録されていない助数詞はデフォルト処理

### 精度

- 基本的な数詞（1-10）+ 一般的な助数詞: 高精度
- 大きな数詞: 読みは正確、アクセントは簡略化
- 特殊な助数詞: カバレッジに限りあり

## 参考文献

- 宮崎正弘・峯松信明・広瀬啓吉（2012）「数詞句のアクセント型予測規則とその評価」日本音響学会講演論文集
  - https://www.gavo.t.u-tokyo.ac.jp/~mine/paper/PDF/2012/ASJ_1-11-11_p319-322_t2012-3.pdf
- NHK日本語発音アクセント新辞典（2016）NHK出版
- 金田一春彦編（2014）『新明解日本語アクセント辞典 第2版』三省堂
