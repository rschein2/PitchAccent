# 複合名詞アクセント結合規則 (Compound Noun Accent Sandhi)

日本語（特に東京方言）において、2つ以上の名詞が結合して複合語を形成する際、アクセントは単純な連結ではなく、特定の規則に従って再計算されます。

## 基本概念

### アクセント核（下がり目）

日本語のピッチアクセントでは、「アクセント核」の位置が重要です：
- **平板型（へいばん・0型）**: 下がり目がない。最初のモーラが低く、残りは高いまま
- **起伏型（きふく）**: 特定の位置で高→低に下がる

```
平板:  せんせい → LHHH（H）  助詞も高いまま
起伏:  がくせい → LHLL（L）  3モーラ目の後で下降、助詞も低い
```

### モーラ（拍）

日本語のリズム単位。1文字＝1モーラが基本ですが：
- 小文字（ゃ、ゅ、ょ）は前のモーラに含まれる: きょ = 1モーラ
- 特殊拍（ん、っ、ー）は1モーラとして数える

## 東京方言の複合名詞アクセント規則

2つの名詞 N1 + N2 が結合する場合、**N2の長さ（モーラ数）** が結合後のアクセント位置を決定します。

### 規則1: N2 ≤ 2モーラ

**N1の最終モーラにアクセント核が移動**

| N1 | N2 | 結合 | アクセント |
|----|----|----|----------|
| 安全[0] | 面[0] | 安全面 | [4] あんぜ**ん**めん |
| 経済[1] | 学[0] | 経済学 | [4] けいざ**い**がく |
| 日本[2] | 語[1] | 日本語 | [0] にほんご（例外：平板化接尾辞）|

**特殊モーラ終わりの例外:**
N1が特殊拍（ん、っ、ー）で終わる場合、アクセント核は1つ前にシフト：
```
東京[0] + 駅[1] → 東京駅[3] とうきょ**う**えき
```

### 規則2: N2 = 3-4モーラ

N2のアクセント型によって挙動が変わる：

**N2が平板型または尾高型の場合:**
N2の第1モーラにアクセント核

| N1 | N2 | 結合 | アクセント |
|----|----|----|----------|
| 安全[0] | 保障[0] | 安全保障 | [5] あんぜんほ**しょ**う |
| 日米[1] | 関係[0] | 日米関係 | [5] にちべいか**ん**けい |

**N2が起伏型（頭高・中高）の場合:**
N2のアクセント位置を保持

| N1 | N2 | 結合 | アクセント |
|----|----|----|----------|
| 学校[0] | 教育[0] | 学校教育 | [5] がっこうきょ**う**いく |

### 規則3: N2 ≥ 5モーラ

**N2のアクセントをほぼそのまま保持**

| N1 | N2 | 結合 | アクセント |
|----|----|----|----------|
| 日米[1] | 安全保障[0] | 日米安全保障 | [0] または [5] |

N2が平板なら複合語全体も平板になりやすい。

## 平板化接尾辞

一部の接尾辞は複合語全体を平板化させる傾向があります：

```python
HEIBAN_SUFFIXES = {
    "語",    # ～語 (言語)
    "色",    # ～色 (色)
    "的",    # ～的 (形容詞化)
    "性",    # ～性 (性質)
    "化",    # ～化 (変化)
    "家",    # ～家 (専門家/家)
    "者",    # ～者 (人)
    "員",    # ～員 (メンバー)
    "式",    # ～式 (スタイル/式)
    "用",    # ～用 (用途)
    "中",    # ～中 (進行中)
    "内",    # ～内 (内部)
    "外",    # ～外 (外部)
    "上",    # ～上 (上・抽象)
    "下",    # ～下 (下・抽象)
    "間",    # ～間 (間)
    "前",    # ～前 (前)
    "後",    # ～後 (後)
    "代",    # ～代 (世代/費用)
    "感",    # ～感 (感覚)
}
```

例: 日本[2] + 語[1] → 日本語[0]（平板）

## 3語以上の複合語

3語以上の場合、**左枝分かれ（left-branching）** で2語ずつ計算：

```
((N1 + N2) + N3)

例: 安全保障面
1. 安全[0] + 保障[0] → 安全保障[5]
2. 安全保障[5] + 面[0] → 安全保障面[7]
```

## 精度について

これらの規則は約80-90%の精度で正しいアクセントを予測します。不正確になる主な原因：

1. **語彙化された例外**: 一部の複合語は規則に従わない固定アクセントを持つ
2. **意味による違い**: 同じ構成でも意味によってアクセントが異なる場合がある
3. **世代・個人差**: 話者によってアクセントが異なる場合がある
4. **新語・専門用語**: 規則が確立されていない

## 実装

本ツールでは `compound_accent.py` でこれらの規則を実装しています：

```python
def compute_compound_accent(n1_reading, n1_accent, n2_reading, n2_accent, n2_surface=""):
    n1_len = count_mora(n1_reading)
    n2_len = count_mora(n2_reading)

    # 平板化接尾辞のチェック
    if n2_surface in HEIBAN_SUFFIXES:
        return (0, "heiban_suffix")

    # Case A: N2 ≤ 2モーラ
    if n2_len <= 2:
        accent_pos = n1_len
        if ends_with_special_mora(n1_reading):
            shift = get_special_mora_at_end_count(n1_reading)
            accent_pos = max(1, n1_len - shift)
        return (accent_pos, "N2≤2_boundary")

    # Case B: N2 = 3-4モーラ
    if 3 <= n2_len <= 4:
        if n2_accent == 0 or n2_accent == n2_len:  # 平板 or 尾高
            return (n1_len + 1, "N2=3-4_initial")
        else:
            return (n1_len + n2_accent, "N2=3-4_preserve")

    # Case C: N2 ≥ 5モーラ
    if n2_accent == 0:
        return (0, "N2≥5_heiban")
    else:
        return (n1_len + n2_accent, "N2≥5_preserve")
```

## 参考文献

- [TUFS言語モジュール - 複合語のアクセント](https://www.coelang.tufs.ac.jp/mt/ja/pmod/practical/02-07-01.php)
- 窪薗晴夫（2006）『アクセントの法則』岩波書店
- 秋永一枝編（2014）『新明解日本語アクセント辞典 第2版』三省堂
